(this.webpackJsonpcad=this.webpackJsonpcad||[]).push([[0],{36:function(e,t,a){e.exports=a(58)},41:function(e,t,a){},42:function(e,t,a){},58:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(13),s=a.n(i),c=(a(41),a(22)),l=a(5),o=a(11),h=(a(42),a(26)),u=a(15),m={TX:"x",TY:"y",TZ:"z"},f=a(43),p=Math.PI/180,d=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],b=function(e){return JSON.parse(JSON.stringify(e))},g=function(e){return b([e[0]/e[3],e[1]/e[3],e[2]/e[3],e[3]/e[3]])},v=function(){function e(){Object(h.a)(this,e),this.g={0:function(e){return(1-e)*(1-e)},1:function(e){return 2*e*(1-e)*(1-e)},2:function(e){return 2*(1-e)*e*e},3:function(e){return e*e}},this.transformSteck=[b(d)],this.transformMatrix=b(d),this.basePoints=[],this.lines=[],this.splines=[],this.surfaces=[],this.backupPoints=[],this.sweep={apply:!1,scale:1,centerRegion:{x:0,y:0}}}return Object(u.a)(e,[{key:"addTransferMatrix",value:function(e,t){var a=b(d);switch(t){case m.TX:a[3][0]=e;break;case m.TY:a[3][1]=e;break;case m.TZ:a[3][2]=e;break;default:throw Error("Unexpected token ".concat(t))}this.transformSteck.push(a)}},{key:"addScaleMatrix",value:function(e,t){var a=b(d);switch(t){case m.TX:a[0][0]=e;break;case m.TY:a[1][1]=e;break;case m.TZ:a[2][2]=e;break;default:throw Error("Unexpected token ".concat(t))}this.transformSteck.push(a)}},{key:"addRotateMatrix",value:function(e,t){var a=e*p;switch(t){case m.TX:this.transformSteck.push([[1,0,0,0],[0,Math.cos(a),Math.sin(a),0],[0,-Math.sin(a),Math.cos(a),0],[0,0,0,1]]);break;case m.TY:this.transformSteck.push([[Math.cos(a),0,-Math.sin(a),0],[0,1,0,0],[Math.sin(a),0,Math.cos(a),0],[0,0,0,1]]);break;case m.TZ:this.transformSteck.push([[Math.cos(a),Math.sin(a),0,0],[-Math.sin(a),Math.cos(a),0,0],[0,0,1,0],[0,0,0,1]]);break;default:throw Error("Unexpected token ".concat(t))}}},{key:"addShiftMatix",value:function(e){var t=b(d);t[1][0]=e,this.transformSteck.push(t)}},{key:"addFocusMatrix",value:function(e){var t=b(d);t[2][3]=0===e?0:1/e,this.transformSteck.push(t)}},{key:"setDefault",value:function(){this.transformSteck=[b(d)],this.transformMatrix=b(d),this.sweep={apply:!1,scale:1,centerRegion:{x:0,y:0}}}},{key:"setSweep",value:function(){for(var e=document.getElementById("canvas"),t=b(this.backupPoints),a=t[0][0],n=t[0][0],r=t[0][1],i=t[0][1],s=0;s<t.length;s++)t[s][0]>n&&(n=t[s][0]),t[s][0]<a&&(a=t[s][0]),t[s][1]>i&&(i=t[s][1]),t[s][1]<r&&(r=t[s][1]);var c=Math.abs(n-a),l=Math.abs(i-r),o=e.width,h=e.height,u=0;u=o>h?h-100:o-100;var m=1;m=c>l?u/c:u/l,this.sweep.apply=!0,this.sweep.scale=m,this.sweep.centerRegion={x:a+c/2,y:r+l/2},this.transformSteck.push([[m,0,0,0],[0,m,0,0],[0,0,m,0],[0,0,0,1]])}},{key:"uploadScene",value:function(e){var t=JSON.parse(e);if(!t.points)throw Error("scene invalide");this.basePoints=b(t.points),this.lines=t.lines?b(t.lines):[],this.splines=t.splines?b(t.splines):[],this.surfaces=t.surfaces?b(t.surfaces):[]}},{key:"draw",value:function(){var e=document.getElementById("canvas");if(console.log(this.transformSteck),e.getContext){var t=e.getContext("2d"),a=[];if(this.sweep.apply){t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height);var n=this.sweep.scale,r=this.sweep.centerRegion;t.translate(e.width/2,e.height/2),t.scale(1,-1),t.translate(-r.x*n,-r.y*n)}else t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),t.translate(e.width/2,e.height/2),t.scale(1,-1);t.strokeStyle="white";for(var i=0;i<this.lines.length;i++){var s=this.lines[i],c=g(f.matrix.multiply([this.basePoints[s[0]]],this.multiplyMatrix())[0]),l=g(f.matrix.multiply([this.basePoints[s[1]]],this.multiplyMatrix())[0]);t.beginPath(),t.moveTo(c[0],c[1]),t.lineTo(l[0],l[1]),t.closePath(),t.stroke(),a.push(c),a.push(l)}for(var o=0;o<this.splines.length;o++){for(var h=[],u=this.splines[o],m=0;m<1.025;m+=.05){for(var p=[0,0,0,0],d=0;d<u.length;d++){var v=this.basePoints[u[d]],k=f.matrix.scalar([v],this.g[d](m))[0];p=f.matrix.addition(p,k)}var E=g(f.matrix.multiply([p],this.multiplyMatrix())[0]);h.push(E),a.push(E)}t.beginPath();for(var y=1;y<h.length;y++)t.moveTo(h[y-1][0],h[y-1][1]),t.lineTo(h[y][0],h[y][1]);t.closePath(),t.stroke()}for(var T=0;T<this.surfaces.length;T++){for(var w=this.surfaces[T],x=[],S=0;S<1.025;S+=.05){for(var C=[],M=0;M<1.025;M+=.05){for(var O=[0,0,0,0],j=0;j<w.length;j++)for(var P=0;P<w[j].length;P++){var Y=this.basePoints[w[j][P]],N=f.matrix.scalar([Y],this.g[j](S)*this.g[P](M))[0];O=f.matrix.addition(O,N)}var Z=g(f.matrix.multiply([O],this.multiplyMatrix())[0]);C.push(Z),a.push(Z)}x.push(C)}for(var X=0;X<x.length;X++){t.beginPath();for(var R=1;R<x[X].length;R++)t.moveTo(x[X][R-1][0],x[X][R-1][1]),t.lineTo(x[X][R][0],x[X][R][1]);t.closePath(),t.stroke()}for(var I=0;I<x.length;I++){t.beginPath();for(var J=1;J<x[I].length;J++)t.moveTo(x[J-1][I][0],x[J-1][I][1]),t.lineTo(x[J][I][0],x[J][I][1]);t.closePath(),t.stroke()}}this.backupPoints=b(a)}}},{key:"multiplyMatrix",value:function(){for(var e=this.transformSteck[0],t=1;t<this.transformSteck.length;t++)e=f.matrix.multiply(e,this.transformSteck[t]);return e}}]),e}(),k=a(85),E=a(79),y=a(86),T=a(80),w=a(27),x=a.n(w),S={width:"35px",marginLeft:"5px"};function C(e){var t=e.label,a=e.name,n=e.onClick,i=e.onChange;return r.a.createElement(k.a,{width:120},r.a.createElement(E.a,{variant:"overline",display:"inline"},t),r.a.createElement(y.a,{margin:"dense",name:a,onChange:i,style:S}),r.a.createElement(T.a,{color:"primary",onClick:function(e){return function(t){n(e)}}(a),size:"small"},r.a.createElement(x.a,{fontSize:"inherit"})))}var M=a(88),O=a(81),j=a(82),P=a(83);var Y=function(){var e,t,a,i=Object(n.useState)(new v),s=Object(o.a)(i,2),h=s[0],u=(s[1],Object(n.useState)((e={},Object(l.a)(e,m.TX,0),Object(l.a)(e,m.TY,0),Object(l.a)(e,m.TZ,0),e))),f=Object(o.a)(u,2),p=f[0],d=f[1],b=Object(n.useState)((t={},Object(l.a)(t,m.TX,1),Object(l.a)(t,m.TY,1),Object(l.a)(t,m.TZ,1),t)),g=Object(o.a)(b,2),y=g[0],T=g[1],w=Object(n.useState)((a={},Object(l.a)(a,m.TX,0),Object(l.a)(a,m.TY,0),Object(l.a)(a,m.TZ,0),a)),x=Object(o.a)(w,2),S=x[0],Y=x[1],N=Object(n.useState)(0),Z=Object(o.a)(N,2),X=Z[0],R=Z[1],I=Object(n.useState)(0),J=Object(o.a)(I,2),B=J[0],F=J[1],z=function(e){h.addTransferMatrix(p[e],e),h.draw()},U=function(e){h.addScaleMatrix(y[e],e),h.draw()},D=function(e){h.addRotateMatrix(S[e],e),h.draw()},L=function(e){d(Object(c.a)({},p,Object(l.a)({},e.target.name,Number(e.target.value))))},W=function(e){T(Object(c.a)({},y,Object(l.a)({},e.target.name,Number(e.target.value))))},$=function(e){Y(Object(c.a)({},S,Object(l.a)({},e.target.name,Number(e.target.value))))},q={marginRight:"2.5px",marginLeft:"2.5px"};return r.a.createElement("main",{id:"app"},r.a.createElement(k.a,{id:"drower"},r.a.createElement("canvas",{id:"canvas",width:"1305",height:"470"})),r.a.createElement(k.a,{id:"fanctions"},r.a.createElement(M.a,{className:"btn-group",raised:!0},r.a.createElement(O.a,null,r.a.createElement(j.a,{style:q,variant:"contained",color:"primary",onClick:function(e){h.draw()}},"\u041e\u0442\u0440\u0438\u0441\u043e\u0432\u0430\u0442\u044c"),r.a.createElement(j.a,{style:q,variant:"contained",color:"primary",onClick:function(e){document.forms.uploadForm.elements.uploadInput.files[0].text().then((function(e){h.uploadScene(e)}))}},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b"),r.a.createElement(j.a,{style:q,variant:"contained",color:"primary",onClick:function(e){h.setSweep()}},"\u0412\u043f\u0438\u0441\u0430\u0442\u044c \u0432 \u044d\u043a\u0440\u0430\u043d"),r.a.createElement(j.a,{style:q,variant:"contained",color:"primary",onClick:function(e){h.setDefault()}},"\u0418\u0441\u0445\u043e\u0434\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435")),r.a.createElement(P.a,null,r.a.createElement("form",{name:"uploadForm"},r.a.createElement("input",{name:"uploadInput",type:"file"})))),r.a.createElement(M.a,{className:"func-group",raised:!0},r.a.createElement(O.a,null,r.a.createElement(E.a,null,"\u0421\u0434\u0432\u0438\u0433"),r.a.createElement(C,{name:m.TX,label:"\u043e\u0441\u044c \u0425",onChange:L,onClick:z}),r.a.createElement(C,{name:m.TY,label:"\u043e\u0441\u044c Y",onChange:L,onClick:z}),r.a.createElement(C,{name:m.TZ,label:"\u043e\u0441\u044c Z",onChange:L,onClick:z}))),r.a.createElement(M.a,{className:"func-group",raised:!0},r.a.createElement(O.a,null,r.a.createElement(E.a,null,"\u041f\u043e\u0432\u043e\u0440\u043e\u0442"),r.a.createElement(C,{name:m.TX,label:"\u043e\u0441\u044c \u0425",onChange:$,onClick:D}),r.a.createElement(C,{name:m.TY,label:"\u043e\u0441\u044c Y",onChange:$,onClick:D}),r.a.createElement(C,{name:m.TZ,label:"\u043e\u0441\u044c Z",onChange:$,onClick:D}))),r.a.createElement(M.a,{className:"func-group",raised:!0},r.a.createElement(O.a,null,r.a.createElement(E.a,null,"\u041c\u0430\u0441\u0448\u0442\u0430\u0431"),r.a.createElement(C,{name:m.TX,label:"\u043e\u0441\u044c \u0425",onChange:W,onClick:U}),r.a.createElement(C,{name:m.TY,label:"\u043e\u0441\u044c Y",onChange:W,onClick:U}),r.a.createElement(C,{name:m.TZ,label:"\u043e\u0441\u044c Z",onChange:W,onClick:U}))),r.a.createElement(M.a,{className:"func-group",raised:!0},r.a.createElement(O.a,null,r.a.createElement(E.a,null,"\u041e\u041f\u041f"),r.a.createElement(C,{name:m.TX,label:"\u043e\u0441\u044c \u0425",onChange:function(e){F(Number(e.target.value))},onClick:function(e){h.addFocusMatrix(B),h.draw()}}))),r.a.createElement(M.a,{className:"func-group",raised:!0},r.a.createElement(O.a,null,r.a.createElement(E.a,null,"\u041a\u043e\u0441\u043e\u0439 \u0441\u0434\u0432\u0438\u0433"),r.a.createElement(C,{name:m.TY,label:"\u043e\u0441\u044c Y",onChange:function(e){R(Number(e.target.value))},onClick:function(e){h.addShiftMatix(X),h.draw()}})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(Y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[36,1,2]]]);
//# sourceMappingURL=main.0fe52750.chunk.js.map